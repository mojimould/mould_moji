%!TEX root = ../RfCPN.tex


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% FOR STYLE OF TOC %%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\RedeclareSectionCommand[
%  tocindent=0em,
%  tocnumwidth=4.25em
%]{part}
%\addtokomafont{partentry}{\def\autodot{}}
\setcounter{tocdepth}{3}
\renewcommand\contentsname{\texorpdfstring{\hbox to 2em{目次}}{目次}}
%%%%% FOR PART %%%%%
\patchcmd{\l@part}{\begingroup}{\begingroup\begingroup\tikzset{every node/.style={rectangle,fill=blue!20,rounded corners}}}{}{}
\patchcmd{\l@part}{\endgroup}{\endgroup\endgroup}{}{}
\DeclareTOCStyleEntry[
  indent=0em, % エントリのインデントを調整
  numwidth=2.35em, % エントリ番号の幅を調整
  pagenumberwidth=19.305pt
]{tocline}{part}
%%%%% FOR CHAPTER %%%%%
\DeclareTOCStyleEntry[
  level=\chaptertocdepth,
  indent=0.85em, % エントリのインデントを調整
  numwidth=1.5em, % エントリ番号の幅を調整
  pagenumberwidth=17.968pt
]{tocline}{chapter}
%%%%% FOR SECTION %%%%%
\DeclareTOCStyleEntry[
  level=\sectiontocdepth,
  indent=2.35em, % エントリのインデントを調整
  numwidth=2.71em % エントリ番号の幅を調整
]{tocline}{section}
%%%%% FOR SUBSECTION %%%%%
\DeclareTOCStyleEntry[
  indent=5.06em, % エントリのインデントを調整
  numwidth=3.9em % エントリ番号の幅を調整
]{tocline}{subsection}
%%%%% FOR SUBSUBSECTION %%%%%
\DeclareTOCStyleEntry[
  indent=8.96em, % エントリのインデントを調整
  numwidth=4.4em % エントリ番号の幅を調整
]{tocline}{subsubsection}
%%%%% FOR TABLE %%%%%
%\DeclareTOCStyleEntry[
%  level=\sectiontocdepth,
%  indent=0em, % エントリのインデントを調整
%  numwidth=2.71em % エントリ番号の幅を調整
%]{tocline}{table}
\titlecontents{table}
[2.35em] % 左インデント
{\addvspace{0pt}} % 上部の垂直スペースとフォーマット
{\contentslabel{1.5em}} % ラベルとテキストの間のスペース
{\hspace*{-1.5em}} % ラベルなしの場合のスペース
{\titlerule*[0.5pc]{.}\contentspage} % ページ番号前のリーダーとページ番号
%%%%% FOR FIGURE %%%%%
%\DeclareTOCStyleEntry[
%  level=\sectiontocdepth,
%  indent=2.35em, % エントリのインデントを調整
%  numwidth=2.71em % エントリ番号の幅を調整
%]{tocline}{figure}
\titlecontents{figure}
[2.0em] % 左インデント
{\addvspace{0pt}} % 上部の垂直スペースとフォーマット
{\contentslabel{1.5em}} % ラベルとテキストの間のスペース
{\hspace*{-1.5em}} % ラベルなしの場合のスペース
{\titlerule*[0.5pc]{.}\contentspage} % ページ番号前のリーダーとページ番号
%%%%% FOR lstlisting %%%%%
%\DeclareTOCStyleEntry[
%  level=\sectiontocdepth,
%  indent=0em, % エントリのインデントを調整
%  numwidth=2.71em % エントリ番号の幅を調整
%]{tocline}{lstlisting}
%%%%% FOR Colmun %%%%%
%\titlecontents{Colmun}
%[2.35em] % 左インデント
%{\addvspace{0pt}} % 上部の垂直スペースとフォーマット
%{\contentslabel{1.5em}} % ラベルとテキストの間のスペース
%{\hspace*{-1.5em}} % ラベルなしの場合のスペース
%{\titlerule*[0.5pc]{.}\contentspage} % ページ番号前のリーダーとページ番号
%%%%% STYLE OF LIST FOR APPENDIX %%%%%
\AtBeginEnvironment{appendices}{%
  \clearrightpage%
  \@appendixtrue%
  \patchcmd{\part}{\newpage}{\relax}{}{}%
  \pretocmd{\part}{\addtocontents{toc}{\protect\tcbline*}}{}{}{}% add page break before parts, except part 1
}
\AtEndEnvironment{appendices}{\clearrightpage}
\AfterEndEnvironment{appendices}{%
  \patchcmd{\part}{\tocAPartSeparateline}{\relax}{}{}%
  \@appendixfalse%
}
