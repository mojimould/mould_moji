%!TEX root = ../RPA_for_Creating_Program_Note.tex

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% DOCUMENTCLASS %%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\documentclass[11pt, twoside, open=any]{scrbook}

\let\tmpcleardoublepage\cleardoublepage
\let\tmpclearpage\clearpage
\let\tmpnewpage\newpage
\input{RfCPN_preamble/RfCPN_packages}
\input{RfCPN_preamble/RfCPN_definitions}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% GEOMETRY %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\geometry{
  a4paper, % paper size
  centering,
  textwidth={6.5in},
  includehead,  % include the head of the page
%  headheight = 13.6pt,
  includefoot,  % include the foot of the page
  top=15.0truemm,
  bottom=-0.5truemm,
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% HEYPERSETUP %%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\hypersetup{
%  pdfcreationdate=date,
%  pdfcreator={upLaTeX with hyperref}, % creator for PDF subjct field
  pdftitle={モールド関連 -主に幾何学的性質-}, % title for PDF subjct field
  pdfsubject={Mould-Related - Mainly Geometric Properties}, % text for PDF subjct field
  pdfauthor={Kurahashi Nobuaki},  % text for PDF Author field
  pdfkeywords={mould, mold}, % keywords
%  pdfproducer=producer, % dvipdfmx
  linktoc=all,
%  linktocpage=false,   % (if it is true) make page number, not text, be link on TOC, LOF and LOT
  pdfcenterwindow=false, % position the document window center of the screen
  pdffitwindow=true,     % resize document window to fit document size
  bookmarksnumbered=true,
  bookmarksopen=true, %bookmarks open
  pdfstartview={FitH}, % Fit, FitV, FitH, FitB
  pdfpagemode=UseThumbs, % set default mode of PDF display
  unicode=true,
  pdfencoding=unicode,   % PDFDocEncoding or Unicode
  colorlinks=true,     % color links
  linkcolor=ai,      % color of links
  urlcolor=ai,         % color of urls
  citecolor=sora,      % color of citation links
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% DISPLAYBREAK %%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\allowdisplaybreaks
%%%%% TO NO PAGE BREAK IN TOC %%%
%\pretocmd{\modHeadchapter}{\addtocontents{lot}{\protect\nopagebreak}}{}{}
%\pretocmd{\modHeadsection}{\ifnum\value{section}=0\addtocontents{lot}{\protect\nopagebreak}\fi}{}{}
%\pretocmd{\subsection}{\ifnum\value{subsection}=0\addtocontents{toc}{\protect\nopagebreak[4]}\fi}{}{}
%\pretocmd{\subsubsection}{\ifnum\value{subsubsection}=0\addtocontents{toc}{\protect\nopagebreak}\fi}{}{}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% UNIT LENGTH %%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\setlength{\unitlength}{1pt}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% LINESPREAD %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\linespread{1.15}\selectfont
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% PARINDENT %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\indentspace}{\setlength\parindent{11pt}}
\indentspace
%\def \globalscale {0.83}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% FOOTNOTE %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\renewcommand*{\footnoteautorefname}{脚注}
\interfootnotelinepenalty=10000
\counterwithout{footnote}{chapter}
\def\@makefnmark{\hbox{}\hbox{\@textsuperscript{\normalfont\@thefnmark}}\hbox{}}
\deffootnote[1em]{1em}{1em}{\textsuperscript{\thefootnotemark}}
\renewcommand\footnoterule{%
  \kern3pt
  \hrule\@width.75\columnwidth
  \kern2.6pt
}
\makesavenoteenv{twoCtable}
\makesavenoteenv{longtable}
\makesavenoteenv{tablePart}
\makesavenoteenv{Column}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% HEADER AND FOOTER %%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\pagestyle{fancy}
\renewcommand{\headrulewidth}{1.5pt}
\renewcommand{\footrulewidth}{0pt}
\newcommand{\commonheadfoot}{
  \fancyhead{}
  \fancyfoot{}
  \fancyfoot[LO]{\tiny\customdate} % footer left fields for main odd pages
  \fancyfoot[RE]{\tiny\customdate} % footer right fields for main even pages
}
\fancypagestyle{emptydate}{\renewcommand{\headrulewidth}{0pt}\commonheadfoot}
\fancypagestyle{front}{
  \commonheadfoot
  \fancyhead[RO]{\thepage}
  \fancyhead[LE]{\thepage}
}
\fancypagestyle{main}{
  \commonheadfoot
  \fancyhead[RO]{\hyperref[sec:\thesection]{{\small\nouppercase\rightmark}}}
  \fancyhead[LO]{$\nicefrac{\thepage\,}{\pageref{LastPage}}$~~{\hyperref[part:\thepart]{\small\partname.\,\thepart}}} % header right fields for all main odd pages
  \fancyhead[RE]{{\hyperref[part:\thepart]{\small\partname.\,\thepart}}~~$\nicefrac{\thepage\,}{\pageref{LastPage}}$} % header right fields for all main odd pages
  \fancyhead[LE]{\hyperref[\ifx\@chapapp\appendixname app:\else chap:\fi\thechapter]{{\sffamily\bfseries\thechapter.\hskip0.75em\nouppercase\Chaptername}}} % header right fields for all main even pages
}
\fancypagestyle{plainheadfront}{
  \commonheadfoot
  %\fancyhead[C]{}
  \fancyhead[LO]{\thepage}
  \fancyhead[RE]{\thepage}
}
\fancypagestyle{plainhead}{
  \commonheadfoot
  \fancyhead[RO]{\hyperref[part:\thepart]{\small\partname.\,\thepart}~~~$\nicefrac{\thepage\,}{\pageref{LastPage}}$}
  \fancyhead[LE]{$\nicefrac{\thepage\,}{\pageref{LastPage}}$}
}
\fancypagestyle{plainheadback}{
  \commonheadfoot
  \fancyhead[RO]{$\nicefrac{\thepage\,}{\pageref{LastPage}}$}
  \fancyhead[LE]{$\nicefrac{\thepage\,}{\pageref{LastPage}}$}
}
\renewcommand*\frontmatter{%
  \if@twoside\cleardoubleoddpage\else\clearpage\fi
  \@frontmattertrue\@mainmatterfalse\@backmatterfalse\pagenumbering{roman}\pagestyle{plainheadfront}%
}
\renewcommand*\mainmatter{%
  \if@twoside\cleardoubleoddpage\else\clearpage\fi
  \@frontmatterfalse\@mainmattertrue\@backmatterfalse\pagenumbering{arabic}\pagestyle{main}%
}
\renewcommand*\backmatter{%
  \if@openright\cleardoubleoddpage\else\clearpage\fi
  \@frontmatterfalse\@mainmatterfalse\@backmattertrue\pagestyle{plainheadback}
}
%\AtBeginEnvironment{theindex}{%
%  \let\oldhyperpage\hyperpage
%  \renewcommand{\hyperpage}[1]{\cdotfill~\oldhyperpage{#1}~}
%}
\AtEndEnvironment{theindex}{%
  \thispagestyle{plainheadback}
  \pagestyle{plainheadback}
}
%%%%% WATERMARK %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\AddLayersToPageStyle{@everystyle@}{WatermarkLayer}
%%%%% SETLIST %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\setlist[enumerate]{listparindent=\parindent, parsep=0pt, partopsep=0pt, topsep=3pt, itemsep=3pt, leftmargin=*}
\setlist[enumerate, 1]{leftmargin=\leftmargini}
%%%%% EQUATION %%%%%%%%%%%%%%%%%%%%%%%%%%%%
\renewcommand{\theequation}{\thesection.\arabic{equation}}
\@addtoreset{equation}{section}
%%%%% CAPTION STYLE %%%%%%%%%%%%%%%%%%%%%%%%%%%%
\captionsetup[figure]{%
  width=.8\textwidth,
  format=hang,
  labelfont={bf, sf},
  labelsep={colon},
  labelformat=simple,
  font={small},
}
\captionsetup[lstlisting]{
  justification=raggedright,
  singlelinecheck=false,
  position=above,
  aboveskip=1.1pt,
  belowskip=0pt,
  labelformat={empty},
  labelfont={bf, sf},
  labelsep={space},
  font={bf, large, sf},
  hypcap=false,
}
\captionsetup[table]{
  justification=raggedright,
  singlelinecheck=false,
  position=above,
  aboveskip=4pt,
  belowskip=5pt,
  labelformat={empty},
  labelfont={bf, sf},
  labelsep={space},
  font={bf, large, sf},
  hypcap=false,
}
%%%%% STYLE OF TABLE OF CONTENTS %%%%%
%\RedeclareSectionCommand[
%  tocindent=0em,
%  tocnumwidth=4.25em
%]{part}
%\addtokomafont{partentry}{\def\autodot{}}
%\RedeclareSectionCommand[
%  tocindent=1.5em,
%  tocnumwidth=1.5em
%]{chapter}
%\RedeclareSectionCommand[
%  tocindent=3em,
%  tocnumwidth=2.5em,
%  tocentrynumberformat=\entrynumberwithdot
%]{section}
%\RedeclareSectionCommand[
%  tocindent=4.5em,
%  tocnumwidth=2.5em,
%  tocentrynumberformat=\entrynumberwithdot
%]{subsection}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% FOR STYLE OF TOC %%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\setcounter{tocdepth}{3}
\renewcommand\contentsname{\texorpdfstring{\hbox to 1.9em{目次}}{目次}}
\patchcmd{\l@part}{\begingroup}{\begingroup\begingroup\tikzset{every node/.style={rectangle,fill=blue!20,rounded corners}}}{}{}
\patchcmd{\l@part}{\endgroup}{\endgroup\endgroup}{}{}
%%%%% STYLE OF LIST FOR APPENDIX %%%%%
\AtBeginEnvironment{appendices}{%
  \@appendixtrue%
  \patchcmd{\part}{\newpage}{\relax}{}{}%
  \pretocmd{\part}{\tocAPartSeparateline{toc}{15pt}{-10pt}}{}{}{}% add page break before parts, except part 1
 % \patchcmd{\part}{\tableAPartSeparateline}{\relax}{}{}%
}
\AfterEndEnvironment{appendices}{%
  \patchcmd{\part}{\tocAPartSeparateline}{\relax}{}{}%
  \addtocontents{toc}{\protect\newpage}% add page break before parts, except the first one
  \@appendixfalse%
}
%%%%% STYLE OF PART FOR LIST %%%%%
%\newcommand{\tocpartnumdeco}[1]{%
%  \begin{tikzpicture}[baseline]
%    \node[draw, rounded corners, fill=blue!20, text=black, minimum width=1.5em, align=center, yshift=4.5pt] (partnumber) {#1};
%  \end{tikzpicture}
%}
%\renewcommand*{\addparttocentry}[2]{%
%  \addtocentrydefault{part}{\tocpartnumdeco{#1}}{#2}%
%}
%\renewcommand*{\partformat}{\thepart\autodot\enskip}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% FOR STYLE OF LOP %%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\renewcommand\listoflopname{\texorpdfstring{\hbox to 2.75em{大項目}}{大項目}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% FOR STYLE OF LOF %%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\renewcommand\listfigurename{\texorpdfstring{\hbox to 2.75em{図目次}}{図目次}}
\renewcommand{\figurename}{図}
\renewcommand{\figureautorefname}{\figurename} % figure --> 図
%\setcounter{lofdepth}{2}
%\renewcommand*\l@figure{\@dottedtocline{1}{1.5em}{3.2em}}
%\renewcommand*{\l@subfigure}{\@dottedxxxline{\ext@subfigure}{2}{4.7em}{2.3em}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% FOR STYLE OF LOC %%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\renewcommand\listofloCname{Column一覧}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% FOR STYLE OF LOT %%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\renewcommand\listtablename{\texorpdfstring{\hbox to 2.75em{表目次}}{表目次}}
\renewcommand{\tablename}{表}
\AtBeginDocument{\renewcommand{\thetable}{}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% FOR STYLE OF LISTLINGS %%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\renewcommand{\lstlistlistingname}{プログラム 目次}
\renewcommand{\lstlistingname}{{\scshape Prg: }}
\AtBeginDocument{%
%  \counterwithout{lstlisting}{chapter}
  \renewcommand{\thelstlisting}{}%
}
\renewcommand*\l@lstlisting{\@dottedtocline{1}{0.6em}{3.2em}}
\lstdefinelanguage{GcodeBasic}{
  sensitive=true,%
  basicstyle=\small\ttfamily\linespread{1}\selectfont,%
  abovecaptionskip=0pt,
  belowcaptionskip=0pt,
%  aboveskip=0\baselineskip,
%  belowskip=0\baselineskip,
  numbers=left,%
  numbersep=6pt,%
  numberstyle=\ttfamily\scriptsize\color{black!75!},%
  breaklines=true,%
  breakindent=3pt,%
  postbreak=\mbox{\textcolor{blue}{$\hookrightarrow$}\,},%
  frame=single,%
  columns=fixed,%
  basewidth=0.53em,%
  lineskip=-1.2pt,
  comment=[l]{(},%
  commentstyle=\footnotesize\color{black!60!green!100}\slshape,%
  stringstyle={},%
  alsoletter={},%
  keywords={},%
  keywordstyle=\bfseries,%
}
\lstdefinestyle{Gcode-more}{
  language=GcodeBasic,
  nolol,
  morekeywords={[20]IF, GOTO, THEN, WHILE, DO1, DO2, END1, END2},%
  keywordstyle={[20]\fontfamily{pcr}\selectfont\bfseries},%
  emph={G90, G91},
  emphstyle={\bfseries\color{red}},
  emph={[2]G53, G54, G55, G56, G57},
  emphstyle={[2]\bfseries\color{blue}},
  emph={[3]G40, G41, G42, G43, G44},
  emphstyle={[3]\bfseries\color{orange}},
  emph={[4]G00, G01, G02, G03, G31},
  emphstyle={[4]\bfseries\color{magenta}},
  emph={[5]G28, G30},
  emphstyle={[5]\bfseries\color{violet}},
  emph={[6]G04, G10, G13, G17, G49, G58, G65, G80},
  emphstyle={[6]\bfseries\color{cyan}},
  emph={[11]
    T01, T02, T06, T11, T13, T16, T31, T50,
    M00, M01, M03, M04, M05, M06, M08, M09,
    M10, M11, M19,
    M30, M32, M33,
    M48, M49,
    M60, M61, M62, M63,
    M71, M72, M73, M74, M78, M79,
    M98, M99,
    M117, M214, M262},
  emphstyle={[11]\fontfamily{pcr}\bfseries\color{yellow!100!green!80!black!100!}},
  emph={[22]SIN, COS, SQRT, FIX, FUP, ROUND, ABS},%
  emphstyle={[22]\fontfamily{pcr}\selectfont\bfseries},%
  emph={[31]
    P140001, P110002, P130001, P130002, P150002, P150003,
    P210003, P220001, P220002, P230001, P230002, P530001, P530002,
    P410000, P420000, P430000, P440000, P450000, P490005,
    P910001, P910002},%
  emphstyle={[31]\bfseries\color{cyan}},%
}
\lstdefinestyle{Gcode-bundle}{
  language=GcodeBasic,
  nolol,
  morekeywords={[120]WHILE, THEN, DO1, DO2, END1, END2},%
  keywordstyle={[120]\fontfamily{pcr}\selectfont\bfseries},%
  emph={[102]},
  emphstyle={[102]\bfseries\color{blue}},
  emph={[111]M10, M11, M19, M30, M32, M33, M48, M49,  M61, M62, M74, M78, M262},
  emphstyle={[111]\fontfamily{pcr}\bfseries\color{yellow!100!green!80!black!100!}},
  emph={[112]M98P9001},
  emphstyle={[112]\bfseries\color{cyan}},
  emph={[122]SIN, COS, SQRT, FIX, FUP, ABS},%
  emphstyle={[122]\fontfamily{pcr}\selectfont\bfseries},%
}
%\lstdefinestyle{Gcode-ren}{
%  language=GcodeBasic,
%  nolol,
%  morekeywords={[220]IF, WHILE, THEN, DO1, DO2, END1, END2},%
%  keywordstyle={[220]\fontfamily{pcr}\selectfont\bfseries},%
%  emph={[202]},
%  emphstyle={[202]\bfseries\color{blue}},
%  emph={[211]M0, M5, M19, M32, M33, M99, M214},
%  emphstyle={[211]\fontfamily{pcr}\bfseries\color{yellow!100!green!80!black!100!}},
%  emph={[222]SIN, COS, TAN, ATAN, SQRT, FIX, FUP, ROUND, DPRNT},%
%  emphstyle={[222]\fontfamily{pcr}\selectfont\bfseries},%
%}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% FOR STYLE OF INDEX %%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\renewcommand{\indexname}{\texorpdfstring{\hbox to 1.9em{索引}}{索引}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% FOR STYLE OF BIBLATEX %%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\renewcommand{\bibname}{\texorpdfstring{\hbox to 3.75em{参考文献}}{参考文献}}
\ExecuteBibliographyOptions{
  sorting=none,
  refsegment=chapter,
  hyperref=true,
  block=nbpar,
  subentry=true,
  citecounter=true,
}
\appto\bibfont{\footnotesize\setstretch{1.1}}
\DeclareFieldFormat{labelnumberwidth}{\mkbibbrackets{#1}\hspace{-6pt}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% FOR STYLE OF PART %%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\renewcommand{\partautorefname}{part}  % part --> part
\renewcommand\partpagestyle{emptydate}
%\renewcommand*{\partformat}{\begin{gtfamily}\thepart\end{gtfamily}}
%\renewcommand{\partname}{}
%\renewcommand{\thepart}{第\hspace{2truemm}\Roman{part}\hspace{2truemm}部} %
%\renewcommand*{\addparttocentry}[2]{\addtocentrydefault{part}{#1}{第#2部}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% FOR STYLE OF CHAPTER %%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\renewcommand{\chapterautorefname}{章}  % chapter --> 章
\renewcommand\chapterpagestyle{\if@frontmatter plainheadfront\else plainhead\fi}
\renewcommand*{\chapterformat}{%
  \begin{tikzpicture}[every node/.style={signal, draw, text=white, signal to=nowhere},
                      baseline=-8.5pt]
    \node[fill=\if@appendix white\else Maroon!65\fi,
          text=\if@appendix Maroon!65\else white\fi,
          signal from=east,
          inner sep=5pt,
          text height=1.5ex,
          text depth=2pt]
      at (0, 0) {\LARGE{\fontfamily{pplx}\bfseries\,\thepart.~\thechapter~~\relax}};
  \end{tikzpicture}~~%
}
%%%%% STYLE OF APPENDICES %%%%%%%%%%%%%%%%%%%%%%%%%%%%
\renewcommand{\setthesection}{\Alph{section}}
%\renewcommand{\appendixname}{補\hskip0.5em 遺} % appendix --> 補 遺
\renewcommand{\appendixautorefname}{補遺\!} % appendix --> 補遺
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% FOR STYLE OF SECTION %%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\renewcommand{\sectionautorefname}{節\!} % section --> 節
\setcounter{secnumdepth}{4}
\renewcommand*{\sectionformat}{%
  \begin{tikzpicture}[every node/.style={signal, draw, text=white, signal to=nowhere},
                      baseline=-5.25pt]
    \node[fill=Green!65!,
          text=white,
          signal from=east,
          inner sep=5pt,
          text height=1.3ex,
          text depth=0pt]
      at (0, 0) {\Large{\fontfamily{pplx}\bfseries\,\thesection~\relax}};
  \end{tikzpicture}~~%
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% FOR STYLE OF SUBSECTION %%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\renewcommand{\subsectionautorefname}{\sectionautorefname} % subsection --> section
\renewcommand*{\subsectionformat}{%
  \begin{tikzpicture}[every node/.style={signal, draw, text=white, signal to=nowhere},
                      baseline=-4pt]
    \node[fill=blue!50!,
          text=white,
          signal from=east,
          inner sep=5pt,
          text height=1.25ex,
          text depth=0pt]
      at (0, 0) {\large{\fontfamily{pplx}\bfseries\,\thesubsection~\relax}};
  \end{tikzpicture}~~%
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% FOR STYLE OF SUBSUBSECTION %%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\renewcommand{\subsubsectionautorefname}{\sectionautorefname} % subsubsection --> section
\renewcommand*{\subsubsectionformat}{%
  \begin{tikzpicture}[every node/.style={signal, draw, text=white, signal to=nowhere},
                      baseline=-3.75pt]
    \node[fill=Green!50!Blue!40!,
          text=white,
          signal from=east,
          inner sep=5pt,
          text height=1.25ex,
          text depth=0pt]
      at (0, 0) {\small{\fontfamily{pplx}\bfseries\,\thesubsubsection~\relax}};
  \end{tikzpicture}~~%
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% FOR STYLE OF PARAGRAPH %%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%for scrbook.cls
\RedeclareSectionCommand[%
  style=section,%
  level=4,%
  indent=0pt,%
  afterindent=false,
  beforeskip=3.25ex \@plus1ex \@minus.2ex,%
  afterskip=0.1ex \@plus.1ex \@minus.1ex,% -1em から変更
  tocindentfollows=subsubsection,%
  tocstyle=section,%
  tocindent=10em,%
  tocnumwidth=5em,% def: 5em
  font=\raggedsection\normalfont\sectfont\gtfamily\nobreak\sball{blue}~
]{paragraph}
%for book.cls
%\renewcommand\paragraph[1]{%
%  \@startsection{paragraph}{\paragraphnumdepth}{0pt}%
%  {3.25ex \@plus1ex \@minus.2ex}% \@plus, \@minusは伸び縮みできるスペースの長さ
%  {0.1ex\@plus.1ex \@minus.1ex}% ここが正だと改行されて、値だけ垂直スペースが入る
%  {\raggedsection\normalfont\sectfont\gtfamily\nobreak\size@paragraph\sball{blue}~}{#1}\noindent
%}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% FOR STYLE OF SUBPARAGRAPH %%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\RedeclareSectionCommand[%
  style=section,%
  level=5,%
  indent=0pt, % default: \scr@parindent,%
  afterindent=false,
  beforeskip=0.5ex \@plus1ex \@minus.2ex,% 3.25ex \@plus1ex \@minus .2ex から変更
  afterskip=0.1ex \@plus.1ex \@minus.1ex,% -1em から変更
  tocstyle=section,%
  tocindent=12em,%
  tocnumwidth=6em%
]{subparagraph}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% FOR STYLE OF TCBSET %%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\definecolor{myheadercolor}{rgb}{0.68, 0.85, 0.90}
\tcbset{%
  %%%%% COLUMNBOX STYLE %%%%%
  Tabularbox/.style={%
    fonttitle=\gtfamily\bfseries,%
    breakable,%
    enhanced jigsaw,%
    left=.5ex,%
    right=.5ex,%
    bicolor,%
    colbacklower=black!10!white,%
    before upper={%
      \setcounter{GlobalFootnote}{\value{footnote}}% GlobalFootnoteValue=footnoteValue
      \let\oldfootnote=\footnote% \oldfootnote=\footnote
      \def\footnote{\stepcounter{GlobalFootnote}\oldfootnote[\arabic{GlobalFootnote}]}% define \footnote to \footnote using counter GlobalFootnote
      \renewcommand\thempfootnote{\arabic{mpfootnote}}% arabic footnote
    },
    after upper={%
      \setcounter{footnote}{\value{GlobalFootnote}}% footnoteValue=GlobalFootnoteValue
      \let\footnote=\oldfootnote% \footnote=\oldfootnote
    },
  },%
  %%%%% COLUMNBOX STYLE %%%%%
  Columnbox/.style={%
    Tabularbox,
    after title=\hfill\termblue{\Columnname~\thetcbcounter},%
  },%
  %%%%% FORMULA STYLE %%%%%
  Formulabox/.style={%
    Tabularbox,
    after title=\hfill\termblue{\Formulaname~\thetcbcounter},%
  },%
  %%%%% FIGUREBOX STYLE %%%%%
  Figurebox/.style={%
    notitle,%
    height=\textwidth,
%    width=\textwidth,
    center upper,%
    center lower,%
    arc=5pt,%
    outer arc=2pt,%
    boxrule=1pt,%
    boxsep=3mm,%
    valign=center,%
    halign=center,%
    left=0pt,%
    right=0pt,%
    colback=green!3!white,%
    colframe=black!25!white,%
    before={\centering},
  },
  %%%%% HIGHLIGHT MATH STYLE %%%%%
%  highlight math/.style={%
%    enhanced,%
%    arc=2pt,%
%    boxrule=0pt,%
%    frame hidden,%
%    fuzzy halo=1pt with blue,%
%    left=0pt,%
%    right=0pt,%
%    top=.4mm,%
%    bottom=.4mm,%
%    colback=yellow!40!white,%
%  },%
  %%%%% HOSOKUBOX STYLE %%%%%
  hosokubox/.style={%
    title={\termblue{\hosokuname~\thetcbcounter}~},%
    attach title to upper,%
    breakable,%
    enhanced jigsaw,%
    size=fbox,%
    arc=0pt,%
    middle=1mm,%
    colback=hosoku,%
    colframe=hosoku,%
    drop lifted shadow={blue!100!white!50!},%
    skin first is subskin of={enhanced jigsaw}{no shadow},%
    skin middle is subskin of={enhanced jigsaw}{no shadow},%
    skin last is subskin of={enhanced jigsaw}{drop lifted shadow={blue!100!white!50!}},%
    segmentation style={draw=black!50!white},%
    after=\smallskip\noindent{\color{white}},%
  },
  %%%%% TWOCTABLEBOX STYLE %%%%%
  twoCtablebox/.style={%
    breakable,%
    enhanced,%
    fonttitle=\bfseries,%
    fontupper=\small\sffamily,%
    colframe=black!50!black,%
    colbacktitle=blue!10!white,%
    coltitle=black,%
    top=0pt,%
    bottom=0pt,%
    left=0pt,%
    right=0pt,%
    enlarge top by=-5pt,
    enlarge bottom by=5pt,
    before upper={%
      \setcounter{GlobalFootnote}{\value{footnote}}% GlobalFootnoteValue=footnoteValue
      \let\oldfootnote=\footnote% \oldfootnote=\footnote
      \def\footnote{\stepcounter{GlobalFootnote}\oldfootnote[\arabic{GlobalFootnote}]}% define \footnote to \footnote using counter GlobalFootnote
      \renewcommand\thempfootnote{\arabic{mpfootnote}}% arabic footnote
%      \renewcommand{\arraystretch}{1.2}% 行の高さを調整
      \setlength{\LTpre}{0pt}%
      \setlength{\LTpost}{0pt}%
      \setlength{\LTleft}{0pt}%
      \setlength{\LTright}{0pt}%
      \setlength\cellspacetoplimit{3.5pt}
      \setlength\cellspacebottomlimit{3.5pt}
      \begin{longtable}{@{}c|Sl@{\extracolsep{\fill}}c}%
      \addtocounter{table}{-1}%
    },%
    after upper={%
      \end{longtable}%
      \setcounter{footnote}{\value{GlobalFootnote}}% footnoteValue=GlobalFootnoteValue
      \let\footnote=\oldfootnote% \footnote=\oldfootnote
    },
  },
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% FOR STYLE OF TIKZSET %%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\tikzset{
  %%%%% SECTIONFORMAT STYLE %%%%%
%  sect/.style={signal, draw, text=white},
%  section/.style={sect, fill=konpeki!100!, signal to=east, inner sep=3pt},
%  subsection/.style={sect, fill=moegi!90!, signal to=nowhere, inner sep=3pt},
%  subsubsection/.style={sect, fill=sssec!100!, signal to=nowhere, inner sep=3pt},
  %%%%% TERMINAL STYLE %%%%%
  terminal/.style={%
    rectangle,%
    minimum size=10pt,%
    rounded corners=1.5mm,%
    thin,%
    draw=black!75,%
    top color=white,%
    font=\fontfamily{pplx},%
    inner sep=3pt,%
    inner xsep=3pt,%
    text height=1ex,%
    text depth=0pt,%
  },
  %%%%% BMATRIX STYLE %%%%%
%  every left delimiter/.style={xshift=.5em},
%  every right delimiter/.style={xshift=-.5em},
%  bmatrix/.style={matrix of math nodes, left delimiter=[, right delimiter=],},
}

\makeatother