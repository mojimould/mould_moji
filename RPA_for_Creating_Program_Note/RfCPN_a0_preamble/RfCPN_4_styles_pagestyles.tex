%!TEX root = ../RPA_for_Creating_Program_Note.tex


%%%%% WATERMARK %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\AddLayersToPageStyle{@everystyle@}{WatermarkLayer}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% HEADER AND FOOTER %%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\clearpairofpagestyles
\automark[chapter]{chapter}
\automark[section]{section}
\setkomafont{pageheadfoot}{\normalfont}
\setkomafont{pagenumber}{\normalfont}
%%%%% commonheadfoot %%%%%
\newcommand{\commonheadfoot}{
  \lofoot{\tiny\customdate}% odd left
  \cofoot{\scriptsize
    \hyperref[chap:IV.17]{コモン変数}\quad
    \hyperref[chap:IV.A]{システム変数}\quad
    \hyperref[chap:V.20]{解析計算}\quad
    \hyperref[chap:VII.I]{Gコード}\quad
    \hyperref[sec:VII.I.2]{Mコード}\quad
    \hyperref[chap:VII.K]{プログラム}%
  }% odd center
  \rofoot{}% odd right
  \lefoot{}% even left
  \cefoot{\scriptsize
    \hyperref[chap:IV.17]{コモン変数}\quad
    \hyperref[chap:IV.A]{システム変数}\quad
    \hyperref[chap:V.20]{解析計算}\quad
    \hyperref[chap:VII.I]{Gコード}\quad
    \hyperref[sec:VII.I.2]{Mコード}\quad
    \hyperref[chap:VII.K]{プログラム}%
  }% even center
  \refoot{\tiny\customdate}
}
%%%%% emptydate %%%%%
\newpairofpagestyles{emptydate}{%
  \clearpairofpagestyles
  \commonheadfoot%
  \RemoveLayersFromPageStyle{emptydate}{emptydate.head.below.line}
}
%%%%% front %%%%%
\newpairofpagestyles{front}{%
  \lohead{}% odd, left
  \cohead{}% odd, center
  \rohead{\thepage}% odd, right
  \lehead{\thepage}% even, left
  \cehead{}% even, center
  \rehead{}% even, right
  \commonheadfoot%
}
%%%%% main %%%%%
\newpairofpagestyles{main}{%
  \lohead{$\nicefrac{\thepage\,}{\pageref{LastPage}}$~~{\hyperref[part:\thepart]{\small\partname.\,\thepart}}}% odd, left
  \cohead{}% odd, center
  \rohead{\hyperref[sec:\thepart.\thesection]{{\small\rightmark}}}% odd, right
  \lehead{\hyperref[\ifx\@chapapp\appendixname app:\else chap:\fi\thepart.\thechapter]{{\sffamily\bfseries\thechapter.\hskip0.75em\Chaptername}}}% even, left
  \cehead{}% even, center
  \rehead{{\hyperref[part:\thepart]{\small\partname.\,\thepart}}~~$\nicefrac{\thepage\,}{\pageref{LastPage}}$}% even, right
  \commonheadfoot%
}
%%%%% plainheadfront %%%%%
\newpairofpagestyles{plainheadfront}{%
  \lohead{$\nicefrac{\thepage\,}{\pageref{LastPage}}$}% odd, left
  \cohead{}% odd, center
  \rohead{}% odd, right
  \lehead{}% even, left
  \cehead{}% even, center
  \rehead{$\nicefrac{\thepage\,}{\pageref{LastPage}}$}% even, right
  \commonheadfoot%
}
%%%%% plainhead %%%%%
\newpairofpagestyles{plainhead}{%
  \lohead{}% odd, left
  \cohead{}% odd, center
  \rohead{{\small\partname.\,\thepart}~~~$\nicefrac{\thepage\,}{\pageref{LastPage}}$}% odd, right
  \lehead{$\nicefrac{\thepage\,}{\pageref{LastPage}}$}% even, left
  \cehead{}% even, center
  \rehead{}% even, right
  \commonheadfoot%
}
%%%%% plainheadback %%%%%
\newpairofpagestyles{plainheadback}{%
  \lohead{$\nicefrac{\thepage\,}{\pageref{LastPage}}$}% odd, left
  \cohead{}% odd, center
  \rohead{}% odd, right
  \lehead{}% even, left
  \cehead{}% even, center
  \rehead{$\nicefrac{\thepage\,}{\pageref{LastPage}}$}% even, right
  \commonheadfoot%
}

%%%%% FOR FRONTMATTER %%%%%
\renewcommand*\frontmatter{%
  \if@twoside\cleardoubleoddpage\else\clearpage\fi
  \@frontmattertrue\@mainmatterfalse\@backmatterfalse\pagenumbering{arabic}\pagestyle{plainheadfront}%
}
%%%%% FOR MAINMATTER %%%%%
\renewcommand*\mainmatter{%
  \if@twoside\cleardoubleoddpage\else\clearpage\fi
  \@frontmatterfalse\@mainmattertrue\@backmatterfalse\pagestyle{main}%
}
%%%%% FOR BACKMATTER %%%%%
\renewcommand*\backmatter{%
  \if@openright\cleardoubleoddpage\else\clearpage\fi
  \@frontmatterfalse\@mainmatterfalse\@backmattertrue\pagestyle{plainheadback}
}
%%%%% FOR THEINDEX %%%%%
\AtEndEnvironment{theindex}{%
  \thispagestyle{plainheadback}
  \pagestyle{plainheadback}
}
