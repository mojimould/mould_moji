%!TEX root = ../RPA_for_Creating_Program_Note.tex


%%%%% WATERMARK %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\AddLayersToPageStyle{@everystyle@}{WatermarkLayer}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% HEADER AND FOOTER %%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\pagestyle{fancy}
\renewcommand{\headrulewidth}{1.5pt}
\renewcommand{\footrulewidth}{0pt}
%%%%% commonheadfoot %%%%%
\newcommand{\commonheadfoot}{
  \fancyhead{}
  \fancyfoot{}
  \fancyfoot[C]{\scriptsize
    \hyperref[chap:IV.16]{コモン変数}\quad
    \hyperref[chap:IV.A]{システム変数}\quad
    \hyperref[part:V]{解析計算}\quad
    \hyperref[chap:VII.I]{Gコード}\quad
    \hyperref[sec:VII.I.2]{Mコード}\quad
    \hyperref[chap:VII.K]{プログラム}}
  \fancyfoot[LO]{\tiny\customdate} % footer left fields for main odd pages
  \fancyfoot[RE]{\tiny\customdate} % footer right fields for main even pages
}
%%%%% emptydate %%%%%
\fancypagestyle{emptydate}{\renewcommand{\headrulewidth}{0pt}\commonheadfoot}
%%%%% front %%%%%
\fancypagestyle{front}{
  \commonheadfoot
  \fancyhead[RO]{\thepage}
  \fancyhead[LE]{\thepage}
}
%%%%% main %%%%%
\fancypagestyle{main}{
  \commonheadfoot
  \fancyhead[RO]{\hyperref[sec:\thepart.\thesection]{{\small\nouppercase\rightmark}}}
  \fancyhead[LO]{$\nicefrac{\thepage\,}{\pageref{LastPage}}$~~{\hyperref[part:\thepart]{\small\partname.\,\thepart}}} % header right fields for all main odd pages
  \fancyhead[RE]{{\hyperref[part:\thepart]{\small\partname.\,\thepart}}~~$\nicefrac{\thepage\,}{\pageref{LastPage}}$} % header right fields for all main odd pages
  \fancyhead[LE]{\hyperref[\ifx\@chapapp\appendixname app:\else chap:\fi\thepart.\thechapter]{{\sffamily\bfseries\thechapter.\hskip0.75em\nouppercase\Chaptername}}} % header right fields for all main even pages
}
%%%%% plainheadfront %%%%%
\fancypagestyle{plainheadfront}{
  \commonheadfoot
  %\fancyhead[C]{}
  \fancyhead[LO]{$\nicefrac{\thepage\,}{\pageref{LastPage}}$}
  \fancyhead[RE]{$\nicefrac{\thepage\,}{\pageref{LastPage}}$}
}
%%%%% plainhead %%%%%
\fancypagestyle{plainhead}{
  \commonheadfoot
  \fancyhead[RO]{\hyperref[part:\thepart]{\small\partname.\,\thepart}~~~$\nicefrac{\thepage\,}{\pageref{LastPage}}$}
  \fancyhead[LE]{$\nicefrac{\thepage\,}{\pageref{LastPage}}$}
}
%%%%% plainheadback %%%%%
\fancypagestyle{plainheadback}{
  \commonheadfoot
  \fancyhead[LO]{$\nicefrac{\thepage\,}{\pageref{LastPage}}$}
  \fancyhead[RE]{$\nicefrac{\thepage\,}{\pageref{LastPage}}$}
}
%%%%% FOR FRONTMATTER %%%%%
\renewcommand*\frontmatter{%
  \if@twoside\cleardoubleoddpage\else\clearpage\fi
  \@frontmattertrue\@mainmatterfalse\@backmatterfalse\pagenumbering{arabic}\pagestyle{plainheadfront}%
}
%%%%% FOR MAINMATTER %%%%%
\renewcommand*\mainmatter{%
  \if@twoside\cleardoubleoddpage\else\clearpage\fi
  \@frontmatterfalse\@mainmattertrue\@backmatterfalse\pagestyle{main}%
}
%%%%% FOR BACKMATTER %%%%%
\renewcommand*\backmatter{%
  \if@openright\cleardoubleoddpage\else\clearpage\fi
  \@frontmatterfalse\@mainmatterfalse\@backmattertrue\pagestyle{plainheadback}
}
%%%%% FOR THEINDEX %%%%%
\AtEndEnvironment{theindex}{%
  \thispagestyle{plainheadback}
  \pagestyle{plainheadback}
}
