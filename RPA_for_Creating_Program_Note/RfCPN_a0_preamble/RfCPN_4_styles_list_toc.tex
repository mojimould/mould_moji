%!TEX root = ../RPA_for_Creating_Program_Note.tex


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% FOR STYLE OF TOC %%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\RedeclareSectionCommand[
%  tocindent=0em,
%  tocnumwidth=4.25em
%]{part}
%\addtokomafont{partentry}{\def\autodot{}}
\setcounter{tocdepth}{3}
\renewcommand\contentsname{\texorpdfstring{\hbox to 1.9em{目次}}{目次}}
%%%%% FOR PART %%%%%
\patchcmd{\l@part}{\begingroup}{\begingroup\begingroup\tikzset{every node/.style={rectangle,fill=blue!20,rounded corners}}}{}{}
\patchcmd{\l@part}{\endgroup}{\endgroup\endgroup}{}{}
\DeclareTOCStyleEntry[
  indent=0em, % エントリのインデントを調整
  numwidth=2.35em % エントリ番号の幅を調整
]{tocline}{part}
%%%%% FOR CHAPTER %%%%%
\DeclareTOCStyleEntry[
  level=\chaptertocdepth,
  indent=0.85em, % エントリのインデントを調整
  numwidth=1.5em % エントリ番号の幅を調整
]{tocline}{chapter}
%%%%% FOR SECTION %%%%%
\DeclareTOCStyleEntry[
  level=\sectiontocdepth,
  indent=2.35em, % エントリのインデントを調整
  numwidth=2.71em % エントリ番号の幅を調整
]{tocline}{section}
%%%%% FOR SUBSECTION %%%%%
\DeclareTOCStyleEntry[
  indent=5.06em, % エントリのインデントを調整
  numwidth=3.5em % エントリ番号の幅を調整
]{tocline}{subsection}
%%%%% FOR SUBSUBSECTION %%%%%
\DeclareTOCStyleEntry[
  indent=8.56em, % エントリのインデントを調整
  numwidth=4.4em % エントリ番号の幅を調整
]{tocline}{subsubsection}
%%%%% STYLE OF LIST FOR APPENDIX %%%%%
\AtBeginEnvironment{appendices}{%
  \@appendixtrue%
  \patchcmd{\part}{\newpage}{\relax}{}{}%
  \pretocmd{\part}{\addtocontents{toc}{\protect\tcbline*}}{}{}{}% add page break before parts, except part 1
}
\AfterEndEnvironment{appendices}{%
  \patchcmd{\part}{\tocAPartSeparateline}{\relax}{}{}%
  \@appendixfalse%
}
