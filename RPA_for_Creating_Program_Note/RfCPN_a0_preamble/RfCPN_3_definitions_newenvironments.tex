%!TEX root = ../RPA_for_Creating_Program_Note.tex


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% NEW ENVIRONMENT %%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% COMMONTABLE %%%%%%%%%%%%%%%%%%
\newenvironment{commonTable}[5]{%
  \rowcolors{3}{#1}{white}
  \if\relax\detokenize{#2}\relax
  \else
%    \setlength{\abovecaptionskip}{0pt}
    \modcaptionof{table}{#2} % 追加したキャプション
    \addtocounter{table}{-1}
  \fi
  \setlength{\LTpre}{3pt}%
  \setlength{\LTpost}{5pt}%
  \setlength{\LTleft}{0pt}%
  \setlength{\LTright}{\fill}%
  \begin{longtable}{#3}
  \hline
  \rowcolor{orange!20!}
  #4\\
  \hline
  \endfirsthead
  \hline
  \rowcolor{orange!20!}
  #4\\
  \hline
  \endhead
  \hline
  \multicolumn{#5}{|r|}{\scriptsize 次ページへ続く} \\
  \hline
  \endfoot
  \hline
  \endlastfoot
}
{%
  \end{longtable}
}
%%%%% multicollongtblr %%%%%
\DefTblrTemplate{contfoot-text}{default}{\small［次のページへ続く］}%
\DefTblrTemplate{conthead-text}{default}{}%
\newenvironment{multicollongtblr}[3][gray!15!]{%
\captionsetup[table]{justification=raggedright}%
\modcaptionof{table}{#2}%
\begin{longtblr}[
  theme=commonlongtblr,
  entry=none,
  label=none,
  presep=0pt,
  postsep=5pt,
]{%
  hlines,
  vlines,
  hline{2}={0.75pt},
  colspec={#3},
  rowhead=1,
  row{odd}={#1},
  row{1}={orange!20!, font=\sffamily\bfseries},
  abovesep=3pt,
  belowsep=1.5pt,
  leftsep=4pt,
  rightsep=4pt,
}
}{%
\end{longtblr}
}
%%%%% multicolbreaklongtblr %%%%%
\newenvironment{twocolbreaktblr}[3][gray!15!]{%
\captionsetup[table]{justification=raggedright}%
\modcaptionof{table}{#2}%
\begin{tblr}[
  theme=commonlongtblr,
  entry=none,
  label=none,
  presep=0pt,
  postsep=5pt,
]{%
  vlines,
  colspec={#3},
  rowhead=1,
  row{odd}={#1},
  row{1}={orange!20!, font=\sffamily\bfseries},
  abovesep=3pt,
  belowsep=1.5pt,
  leftsep=4pt,
  rightsep=4pt,
}
}{%
\end{tblr}
}
