%!TEX root = ../RPA_for_Creating_Program_Note.tex


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% NEWTCOLORBOX %%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcounter{GlobalFootnote}% difine a counter Global Footnote
%%%%% PART %%%%%
\newcommand{\tablePartnname}{\thepart}
\newtcolorbox[auto counter, number within=part]{tablePart}[2][]{%
  Columnbox,
  title={\termblue{\tablePartnname：#2}},
  #1,
  after title={}
}
%%%%% COLUMN %%%%%
\newcommand{\Columnname}{Column}
\newtcolorbox[auto counter, number within=chapter, list inside=loC]{Column}[2][]{%
  Columnbox,
  title={#2},
  #1,
  list entry={\numberline{\protect\hspace*{9.5pt}\Columnname~\thetcbcounter}{\protect\hspace*{55pt}#2}}
}
%\newcommand{\tcb@cnt@Columnautorefname}{Column}
%%%%% Formula %%%%%
\newcommand{\Formulaname}{Eq.}
\newtcolorbox[auto counter, number within=chapter]{Formula}[2][]{%
  Formulabox, title={#2}, #1}
\newcommand{\tcb@cnt@Formulaautorefname}{Eq.\!}
%%%%% FIGBOX %%%%%
\newtcolorbox{Figbox}[1][]{Figurebox, #1}
%%%%% TABBOX %%%%%
\newtcolorbox{Tabbox}[1][]{Tabularbox, #1}
%\renewcommand{\tableautorefname}{表}
%%%%% TOCPART %%%%%
%\newcommand{\tocpagebox}[1]{%
%  \node[draw, red!40!black!60!, line width=0.5mm, fill=red!50!yellow!70!black!60!, anchor=east,
%        font=\sffamily\bfseries\large, text=white, inner sep=2mm, rounded corners,
%       ] at ([xshift=-5mm]frame.north east) {#1};
%}
\newtcolorbox{tocBox}[1]{%
  tocstyle,%
  watermark text={\bfseries\Large{#1}},%
}
\newtcolorbox{lopBox}[1]{%
  lopstyle,%
  title={#1},%
%  underlay first={\tocpartpagebox{\pageref{#3}}},
%  underlay unbroken={\tocpartpagebox{\pageref{#3}}},
}
%%%%% HOSOKU %%%%%
\newcommand{\hosokuname}{補}
\definecolor{hosoku}{cmyk}{0, 0, 0, .1}
\newtcolorbox[auto counter, number within=chapter]{hosoku}[1][]{hosokubox, #1}
\newcommand{\tcb@cnt@hosokuautorefname}{補足}
%%%%% MARKER %%%%%
\newtcolorbox{marker}[1][]{enhanced,
  before skip balanced=2mm,after skip balanced=3mm,
  boxrule=0.4pt,left=5mm,right=2mm,top=1mm,bottom=1mm,
  colback=yellow!50,
  colframe=yellow!20!black,
  sharp corners,rounded corners=southeast,arc is angular,arc=3mm,
  underlay={%
    \path[fill=tcbcolback!80!black] ([yshift=3mm]interior.south east)--++(-0.4,-0.1)--++(0.1,-0.2);
    \path[draw=tcbcolframe,shorten <=-0.05mm,shorten >=-0.05mm] ([yshift=3mm]interior.south east)--++(-0.4,-0.1)--++(0.1,-0.2);
    \path[fill=yellow!50!black,draw=none] (interior.south west) rectangle node[white]{\Huge\bfseries !} ([xshift=4mm]interior.north west);
    },
  drop fuzzy shadow,#1}
