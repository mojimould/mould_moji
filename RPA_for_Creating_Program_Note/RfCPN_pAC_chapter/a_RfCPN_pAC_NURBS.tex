%!TEX root = ../RPA_for_Creating_Program_Note.tex



\index{アイソパラメトリックきょくせん@アイソパラメトリック曲線}アイソパラメトリック曲線は、その曲線が属するパラメトリックサーフェスの形状に依存する。
一般に、パラメトリックサーフェスは、パラメータ$u$, $v$を用いて次のように表すことができる。
\begin{align*}
  S(u, v) &=
  \left[
  \begin{array}{c}
    x(u, v)\\
    y(u, v)\\
    z(u, v)
  \end{array}
  \right]
\end{align*}
ここで、$x(u,v)$, $y(u,v)$, $z(u,v)$はサーフェスの各座標を定義する関数である。
アイソパラメトリック曲線は、このサーフェス上の一定の$u$または$v$の値に対応する曲線を指す。
したがって、アイソパラメトリック曲線は次のように表すことができる。
\begin{align*}
  C(t) = S\big(u(t), v(t)\big)\ .
\end{align*}
ここで$u(t)$, $v(t)$はパラメータであり、どちらかが一定（例えば$u(t)=k$または$v(t)=k$）で、もう一方のパラメータは$t$に対して変化する。
たとえば$v(t) = k$ ($k = \text{const.}$)とすると、
\begin{align*}
  C(u) = S\big(u(t), k\big)
\end{align*}
と表すことができる。
これを改めて、$u$で記述される基底関数$f_i(u)$と制御点$P_i$を用いて
\begin{align*}
  C(u) = \sum_{i=0}^nf_i(u)P_i
\end{align*}
と表すことにする。
こうすることで、曲面$S(u, v)$の一部を切り出した曲線$C(u)$は、\index{きていかんすう（アイソパラメトリックきょくせん）@基底関数（アイソパラメトリック曲線}基底関数$f_i(u)$と\index{せいぎょてん（NURBSきょくせん）@制御点（NURBS曲線）}制御点$P_i$の組み合わせで表現することができる。

ここではこのようなアイソパラメトリック曲線の1つの例として、\index{B-スプラインきょくせん@B-スプライン曲線}B-スプライン曲線を見ていくことにする。



\clearpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% section E.2 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\modHeadsection{Bスプライン曲線}
\index{きていかんすう（B-スプラインきょくせん）@基底関数（B-スプライン曲線}基底関数$f_i(u)$として、次のような再帰的に定義される$N_{i, p}(u)$を考える。
\begin{gather*}
  N_{i, p}(u)
  = \frac{u-u_i}{u_{i+p}-u_i}N_{i, p-1}(u)
    +\frac{u_{i+p+1}-u}{u_{i+p+1}-u_{i+1}}N_{i+1, p-1}(u)\\
  N_{i, 0}(u)
  = \left\{
    \begin{array}{l}
      1\quad \big(\text{if}~u_i \leqq u < u_{i+1}\big)\\
      0\quad (\text{otherwise})
    \end{array}
    \right.
\end{gather*}
ここで、$u_i$は\index{ノットベクトル}ノットベクトルと呼ばれるベクトル$U$の成分である。
$N_{i, p}(u)$は$u_i \leqq u < u_{i+p+1}$の範囲で定義され、この範囲外では$0$となる。

パラメータ$u$が特定の区間$[u_j , u_{j+1})$にあるとき、0とならないのは$N_{j-p, p}(u)$から$N_{j, p}(u)$のみである。
よって、すべての$N_{i, p}$を足し合わせると、
\begin{align*}
  \sum_{i=0}^nN_{i, p}(u) = \sum_{i=j-p}^j\!\!N_{i, p}(u) = 1\ .
\end{align*}
これは基底関数$N_{i, p}(u)$を用いて与えられるB-スプライン曲線が、その制御点$P_i$の\index{とつけつごう@凸結合}凸結合であることを示している。
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% hosoku %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{hosoku}
実際、このとき
\begin{align*}
  C(u) = \sum_{i=0}^nN_{i, p}(u)P_i\qquad\left(\sum_{i=0}^nN_{i, p}(u) =1\right)
\end{align*}
と表され、これは制御点$P_i$の\index{かじゅうさんじゅつへいきん（NURBSきょくせん）@加重算術平均（NURBS曲線）}加重算術平均（\index{ウェイトさんじゅつへいきん（NURBSきょくせん）@ウェイト算術平均（NURBS曲線）}ウェイト算術平均, \index{おもみつきさんじゅつへいきん（NURBSきょくせん）@重み付き算術平均（NURBS曲線）}重み付き算術平均）とみなすことができる。
つまり、一種の重心のようなものであり、B-スプライン曲線は常に制御点$P_i$に囲まれた領域に存在することを意味する。
\end{hosoku}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Column %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{Column}{凸結合}
凸結合とは\index{きかがく@幾何学}幾何学の用語であり、ある点集合に対してその点集合の中の任意の2点を結ぶ線分が全てその点集合の中に含まれる性質を指す。
具体的には、2つの点$P$, $Q$が与えられたとき、それらの間の任意の点$R$は次のように表さすことができる。
\begin{align*}
  R = tP+(1-t)Q\qquad\big(0 \leqq t \leqq 1\big)\ .
\end{align*}
これは点$R$が点$P$と点$Q$の間に位置することを示し、また$t$の値によって点$R$は点$P$と点$Q$の間をなめらかに移動する。
したがって凸結合は、ある点集合の任意の2点を結ぶ線分が全てその点集合の中に含まれるという性質を示す。
すなわち、今の場合は曲線が制御点の範囲内に存在するという性質を示す。
\end{Column}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\clearpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% subsection E.4.3 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{非一様B-スプライン曲線}
\index{ノットかんかく@ノット間隔}ノット間隔$u_{j+1}-u_j$がすべて等しい場合は一様(uniform)であるという。
一般には、ノットベクトルは非一様(non-uniform)である。
ここでは一様である場合も含めて、\index{ひいちようB-スプラインきょくせん@非一様B-スプライン曲線}非一様B-スプライン曲線と呼ぶこととする。


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% subsection E.4.3 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{有理B-スプライン曲線}
基底関数として、$N_{i, p}(u)$に対して\index{ウェイト（NURBSきょくせん）@ウェイト（NURBS曲線）}ウェイト（\index{重み（NURBSきょくせん）@重み（NURBS曲線）}重み）$w_i$\,($>0$)をつけた
\begin{align*}
  \frac{N_{i, p}(u)w_i}{\displaystyle\sum_{j=0}^nN_{j, p}(u)w_j}
\end{align*}
を考える。
これは制御点$P_i$についての\index{かじゅうさんじゅつへいきん（NURBSきょくせん）@加重算術平均（NURBS曲線）}加重算術平均とみなすことができ、この基底関数の総和は1となることがわかる。
ウェイト$w_i$がすべて1の場合は非有理(non-rational)であるという。
このときB-スプライン曲線は次のように表すことができる。
\begin{align*}
  C(u) = \sum_{i=0}^nN_{i, p}(u)P_i~~, \quad
  U = \left\{u_0, u_1, u_2, \cdots, u_{n+p+1}\right\}\ .
\end{align*}
一般には、B-スプライン曲線は有理(rational)である。
ここでは非有理である場合を含めて、\index{ゆうりB-スプラインきょくせん@有理B-スプライン曲線}有理B-スプライン曲線と呼ぶこととする。


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% subsection E.1.4 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{非一様有理B-スプライン曲線}
以上より、非一様有理B-スプライン(Non-Uniform Rational B-Spline)曲線は、次のように定義される。
\begin{align*}
  C(u) = \frac{\displaystyle\sum_{i=0}^nN_{i, p}(u)w_iP_i}{\displaystyle\sum_{i=0}^nN_{i, p}(u)w_i}~~,\quad
  U = \left\{u_0, u_1, u_2, \cdots, u_{n+p+1}\right\}\ .
\end{align*}
$U$は\index{ひいちようノットベクトル@非一様ノットベクトル}非一様ノットベクトルである。

これは\index{NURBSきょくせん@NURBS曲線}NURBS曲線と呼ばれ、\index{CAD}CAD等のソフトウェアで曲線の描画の際に広く用いられる。
そのためここではさらにNURBS曲線について見ていく。



\clearpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% section E.2 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\modHeadsection{NURBS曲線}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Column %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{Column}{B-スプライン}
スプラインとは製図等に用いられる一種の自在定規で、しなやかで弾力のある細長い板を指す。
平面上の通過すべき点でたわみを支えると、それらを結ぶ滑らかな曲線が得られる。
これは弾性エネルギーを最小にする曲線であり、数学的には3次のスプライン曲線となる。

　また、B-スプラインのBはBasisを意味する。
これは基底関数の集合から構成されることを示している。

　つまりB-スプライン曲線とは、基底関数の集合から構成されるスプラインを表す曲線、というような意味である。
\end{Column}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
