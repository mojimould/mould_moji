%!TEX root = ../RPA_for_Creating_Program_Note.tex

\makeatletter

\input{RfCPN_p0_preamble/RfCPN_pictures}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% DATE %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\customtoday}{\the\year/\two@digits{\the\month}/\two@digits{\the\day}}
\newcommand{\customdate}{\customtoday\ \currenttime\ (\jadayofweek{\the\year}{\the\month}{\the\day})}
\newcommand{\customtodayap}{\ifnum\currenthour<12 \customtoday\,a.m.\else\customtoday\,p.m.\fi}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% NEWIF %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newif\if@backmatter%\@backmattertrue
\newif\if@frontmatter%\@frontmattertrue
\newif\if@appendix%\@appendixfalse
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% CLEARLEFTPAGE %%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\thispageNum}{\the\value{page}}
\newcommand{\clearleftpage}{%
  \if@twoside%
    \ifodd\thispageNum%
      \clearpage%
    \else
      \cleardoublepage%
    \fi
  \else%
    \clearpage%
  \fi
}
\newcommand{\clearrightpage}{%
  \if@twoside%
    \ifodd\thispageNum%
      \cleardoublepage%
    \else%
      \clearpage%
    \fi
  \else%
    \clearpage%
  \fi
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% DIMENSION %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\ifluatex
  \usepackage{luatexja}
  \ltjsetparameter{kanjiskip=0.0pt plus 0.4pt minus 0.5pt}
  \ltjsetparameter{xkanjiskip=2.40555pt plus 1.0pt minus 1.0pt}
  \newcommand{\hk}{\hspace{\ltjgetparameter{kanjiskip}}}
  \newcommand{\hx}{\hspace{\ltjgetparameter{xkanjiskip}}}
\else
  \setlength{\kanjiskip}{0.0pt plus 0.4pt minus 0.5pt}
  \setlength{\xkanjiskip}{2.40555pt plus 1.0pt minus 1.0pt}
  \newcommand{\hk}{\hspace{\kanjiskip}}
  \newcommand{\hx}{\hspace{\xkanjiskip}}
\fi
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% CDOTFILL LIKE TOC %%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\newcommand\cdotfill{%
%  \leaders\hbox{$\m@th\mkern\@dotsep mu\hbox{$\cdot$}\mkern \@dotsep mu$}\hfill\kern\z@
%}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% COLOR %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\definecolor{ai}     {rgb}{0.2039, 0.3765, 0.4314}
\definecolor{kon}    {rgb}{0.0000, 0.2000, 0.4000}
\definecolor{konpeki}{rgb}{0.0902, 0.5098, 0.7333}
\definecolor{moegi}  {rgb}{0.3020, 0.5961, 0.1882}
\definecolor{sssec}  {rgb}{0.7333, 0.5, 0.7333}
\definecolor{sora}   {rgb}{0.1451, 0.7216, 0.8039}
\definecolor{sumire} {rgb}{0.3882, 0.2157, 0.5922}
\definecolor{wwqqcc} {rgb}{0.4, 0, 0.8}
\definecolor{qqzzqq} {rgb}{0, 0.6, 0}
\definecolor{ffwwqq} {rgb}{1, 0.4, 0}
\colorlet{unusingVariables}{gray!25!}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% REF %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% AUTOREFNAME %%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\newcommand{\subfigureautorefname}{\figureautorefname} % subfigure --> figure
%\newcommand{\subtableautorefname}{\tableautorefname}
%%%%% PAGEREF %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\pageautoref}[1]{%
  \ifthenelse{\equal{\pageref{#1}}{\thepage}}%
    {\autoref{#1}}%
    {\autoref{#1}~[p.\pageref{#1}]}%
}
\newcommand{\pageeqref}[1]{%
  \ifthenelse{\equal{\pageref{#1}}{\thepage}}%
    {\eqref{#1}}%
    {\eqref{#1}~[p.\pageref{#1}]}%
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% FOR LISTINGS %%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% CAPTOINOF %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\setlength{\abovecaptionskip}{0pt}
\newcommand{\modcaptionof}[2]{%
  \captionof{#1}{%
    \csname #1name\endcsname\thechapter.%
    \ifnum\value{#1}<10 0\fi
      \arabic{#1}. #2}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% FOR REFERENCES %%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\Articlename}{論文}
\newcommand{\Bookname}{書籍}
\newcommand{\OnlineSourcename}{ウェブサイト}
\defbibheading{articles}[\Articlename]{\section*{#1}}
\defbibheading{online}[\OnlineSourcename]{\section*{#1}}
%%%%% DECLAREFIELDFORMAT %%%%%%%%%%%%%%%%%%%%
\DeclareFieldFormat{urldate}{%
  (\textbf{urlseen~}\thefield{urlyear}/\ifnum\thefield{urlmonth}<10 0\fi\thefield{urlmonth})%
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% FOR TOC %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% TOC LINE %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand\PartSeparateline[1]{\addtocontents{#1}{\protect\par\protect\hrulefill\protect\par\protect\vspace*{-10pt}}}%
\newcommand\tocAPartSeparateline[3]{\addtocontents{#1}{\protect\par\protect\vspace*{#2}\protect\hrule width 0.5\linewidth\protect\par\protect\vspace*{#3}}}%
%\newcommand\tableAPartSeparateline{\tocAPartSeparateline{lot}{2pt}{2pt}}
%%%%% PART FOR APPENDIX %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\Appendixpart}{
  \clearrightpage
  \part*{\partname\ \thepart\hx の補遺\label{Apart:\thepart}}
  \addcontentsline{toc}{part}{\partname\ \thepart\hx の補遺}
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% AUTO LABELING %%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% FOR CHAPTER OR APPENDIX %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\modHeadchapter}[2][]{%
  \clearrightpage\clearleftpage
  \let\newpage\relax
  \ifx\relax#1\relax
    \ifx\@chapapp\appendixname
      \chapter{#2\label{app:\thepart.\thechapter}}%
    \else
      \chapter{#2\label{chap:\thepart.\thechapter}}%
    \fi
  \else%
    \ifx\@chapapp\appendixname
      \chapter[#1]{#2\label{app:\thepart\thechapter}}%
    \else
      \chapter[#1]{#2\label{chap:\thepart\thechapter}}%
    \fi
  \fi
  \thispagestyle{main}%
  \indentspace%
  \let\newpage\tmpnewpage
}
%%%%% FOR SECTION %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% TO LABEL SECTION  %%%%%%
\newcommand{\modHeadsection}[2][]{%
  \ifx\relax#1\relax
    \section{#2\label{sec:\thepart.\thesection}}%
  \else%
    \section[#1]{#2\label{sec:\thepart.\thesection}}%
  \fi
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% NEWCOLORBOX %%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcounter{GlobalFootnote}% difine a counter Global Footnote
%%%%% PART %%%%%
\newcommand{\tablePartnname}{\thepart}
\newtcolorbox[auto counter, number within=part]{tablePart}[2][]{%
  Columnbox,
  title={\termblue{\tablePartnname：#2}},
  #1,
  after title={}
}
%%%%% COLUMN %%%%%
\newcommand{\Columnname}{Column}
\newtcolorbox[auto counter, number within=chapter, list inside=loC]{Column}[2][]{%
  Columnbox,
  title={#2},
  #1,
  list entry={\numberline{\protect\hspace*{13.5pt}\Columnname~\thetcbcounter}{\protect\hspace*{55pt}#2}}
}
%\newcommand{\tcb@cnt@Columnautorefname}{Column}
%%%%% Formula %%%%%
\newcommand{\Formulaname}{Eq.}
\newtcolorbox[auto counter, number within=chapter]{Formula}[2][]{%
  Formulabox, title={#2}, #1}
\newcommand{\tcb@cnt@Formulaautorefname}{Eq.\!}
%%%%% FIGBOX %%%%%
\newtcolorbox{Figbox}[1][]{Figurebox, #1}
%%%%% TABBOX %%%%%
\newtcolorbox{Tabbox}[1][]{Tabularbox, #1}
%\renewcommand{\tableautorefname}{表}
%%%%% HOSOKU %%%%%
\newcommand{\hosokuname}{補}
\definecolor{hosoku}{cmyk}{0, 0, 0, .1}
\newtcolorbox[auto counter, number within=chapter]{hosoku}[1][]{hosokubox, #1}
\newcommand{\tcb@cnt@hosokuautorefname}{補足}
%%%%% TWOCTABLE %%%%%
\newtcolorbox[number within=chapter]{twoCtable}[2][]{twoCtablebox, title={#2}, #1}
%%%%% OTHER TIKZ DEFINITION %%%%%%%%%%%%%%%%%%
\def\pgfname{\textsc{pgf}}
\def\tikzname{Ti\textit{k}Z}
\tikzfading[name=fade ball, inner color=transparent!60, outer color=transparent!30]
\def\sball#1{\tikz \shade [ball color=#1, path fading=fade ball] (0,0) circle (.7ex);}
\def\terminal#1#2{\tikz[baseline=(a.base)] \node (a) [terminal, bottom color=#2] {\small #1};}
\def\termblue#1{\terminal{\color{blue}\fontsize{8pt}{0pt}\textbf{#1}}{gray!25}\hskip6pt}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% DECLARE %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% DECLAREMATHOPERATOR %%%%%%%%%%%%%%%%%%%%
\DeclareMathOperator{\IP}{Im}
\DeclareMathOperator{\RP}{Re}
%%%%% DECLAREROBUSTCOMMAND %%%%%%%%%%%%%%%%%%%%
\DeclareRobustCommand{\bDiv}{\nonscript\mskip-\medmuskip\mkern5mu\mathbin
  {\operator@font div}\penalty900
  \mkern5mu\nonscript\mskip-\medmuskip}
\DeclareRobustCommand{\pod}[1]{\allowbreak
  \if@display\mkern18mu\else\mkern8mu\fi(#1)}
\DeclareRobustCommand{\pDiv}[1]{\pod{{\operator@font div}\mkern6mu#1}}
\DeclareRobustCommand{\Div}[1]{\allowbreak\if@display\mkern18mu
  \else\mkern12mu\fi{\operator@font div}\,\,#1}
%%%%% DECLARENEWTOC %%%%%%%%%%%%%%%%%%%%
\DeclareNewTOC[owner=\jobname, name=Part]{lop}
\DeclareNewTOC[owner=\jobname, name=Column]{loC}
%%%%% DECLARENEWLAYER %%%%%%%%%%%%%%%%%%%%
\newcommand{\setallpageWatermark}[4]{%
  \DeclareNewLayer[
    foreground,
    page,
    contents={%
      \begin{tikzpicture}[remember picture, overlay]
        \node[rotate=#2, scale=#3, anchor=center, opacity=#4, text=lightgray] at (current page.center){\scshape#1};%
      \end{tikzpicture}%
    }%
  ]{WatermarkLayer}
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% LINK %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% LINK NAME %%%%%%%%%%%%%%%%%%
\newcommand{\linkLaTeX}{\href{https://www.latex-project.org/}{\LaTeX}}
\newcommand{\linkLaTeXProject}{\href{https://www.latex-project.org/}{\LaTeX\ Project}}
\newcommand{\linkAMS}{\href{https://www.latex-project.org/}{American Mathematical Society}}
\newcommand{\linkTeXLive}{\href{https://tug.org/texlive/}{\TeX\ Live}}
\newcommand{\linkTeXUsersGroup}{\href{http://www.tug.org/}{\TeX\ Users Group}}
\newcommand{\linkBibLaTeX}{\href{https://ctan.org/pkg/biblatex}{Bib\LaTeX}}
\newcommand{\linkBiber}{\href{https://ctan.org/pkg/biber}{Biber}}
\newcommand{\linkupmendex}{\href{https://ctan.org/pkg/upmendex}{upmendex}}
\newcommand{\linkPGFTikZ}{\href{https://github.com/pgf-tikz/pgf}{\pgfname/\tikzname}}
\newcommand{\linkTeXStudio}{\href{https://texstudio.org/}{\TeX\ Studio}}
\newcommand{\linkSumatraPDF}{\href{https://www.sumatrapdfreader.org/}{Sumatra PDF}}
\newcommand{\linkVSCode}{\href{https://code.visualstudio.com/}{VS Code}}
\newcommand{\linkWolframAlpha}{\href{https://www.wolframalpha.com/}{Wolfram\textbar Alpha}}
\newcommand{\linkWolfram}{\href{https://www.wolfram.com/}{Wolfram Research}}
\newcommand{\linkExcel}{\href{https://www.microsoft.com/ja-jp/microsoft-365/excel}{Excel}}
\newcommand{\linkMicrosoftCopilot}{\href{https://www.bing.com/}{Microsoft Copilot}}
\newcommand{\linkMicrosoftCorp}{\href{https://www.microsoft.com/}{Microsoft Corporation}}
\newcommand{\linkPython}{\href{https://www.python.org/}{Python}}
\newcommand{\linkPythonSF}{\href{https://www.python.org/psf-landing/}{Python Software Foundation}}
\newcommand{\linkGitHub}{\href{https://github.com/}{GitHub}}
\newcommand{\linkGitHubDesktop}{\href{https://desktop.github.com/}{GitHub Desktop}}
\newcommand{\linkGitHubInc}{\href{https://github.com/}{GitHub, Inc}}
\newcommand{\linkDocker}{\href{https://www.docker.com/}{Docker}}
\newcommand{\linkDockerInc}{\href{https://www.docker.com/}{Docker, Inc}}
\newcommand{\linkUbuntu}{\href{https://ubuntu.com/}{Ubuntu}}
\newcommand{\linkCanonicalLtd}{\href{https://canonical.com/}{Canonical Ltd}}
\newcommand{\linkSQLite}{\href{https://www.sqlite.org/}{SQLite}}
\newcommand{\linkSQLiteConsortium}{\href{https://www.sqlite.org/consortium.html}{SQLite Consortium}}
\newcommand{\linkChatGPT}{\href{https://openai.com/chatgpt}{ChatGPT}}
\newcommand{\linkOpenAI}{\href{https://www.openai.com/}{OpenAI}}
%\newcommand\nextsectionlink[1]{\addtocounter{section}\@ne
%                               \hyperlink{section.\thechapter.\the\c@section}{#1}%
%                               \addtocounter{section}{-\@ne}}
%\newcommand\previoussectionlink[1]{\addtocounter{section}{-\@ne}
%                                   \hyperlink{section.\thechapter.\the\c@section}{#1}%
%                                   \addtocounter{section}{\@ne}}
%\newcommand\previouschapterlink[1]{\addtocounter{chapter}{-\@ne}
%                                   \hyperlink{chapter.\the\c@chapter}{#1}%
%                                   \addtocounter{chapter}{\@ne}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% OTHER DEFINITION %%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% TO GET CHAPTER TITLE %%%%%%
\newcommand\Chaptername{} % initialize \Chaptername
\let\old@chapter\@chapter
\def\@chapter[#1]#2{\gdef\Chaptername{#2}\old@chapter[#1]{#2}}
%%%%% TO GET SECTION TITLE %%%%%%
\newcommand\Sectionname{} % initialize \Sectionname
\let\Sectionmark\sectionmark
\def\sectionmark#1{\def\Sectionname{#1}\Sectionmark{#1}}
%%%%% TO PRG NAME %%%%%%
\newcommand\MainEx{O1916} % main program example
\newcommand\MXOThickness{O110001} % X outer center measurement
\newcommand\MYOThickness{O110002} % Y outer center measurement
\newcommand\MXOface{O120001} % keyway X reference surface measurement
\newcommand\MXIWidth{O130001} % X inner center measurement
\newcommand\MYIWidth{O130002} % Y inner center measurement
\newcommand\MXIface{O140001} % outer cut X reference surface measurement
\newcommand\MYcenterline{O150002} % Y centerline measurement
\newcommand\MXcenterline{O150003} % X centerline measurement (Z measurement)
\newcommand\DLone{O210003} % for dimple level 1
\newcommand\DLtwoAC{O220001} % for dimple level 2 AC
\newcommand\DLtwoBD{O220002} % for dimple level 2 BD
\newcommand\DMLthreeAC{O230001} % for dimple level 3 AC measurement
\newcommand\DMLthreeBD{O230002} % for dimple level 3 BD measurement
\newcommand\KTanmenRight{O410000} % end face left turn
\newcommand\KGaisakuRLeft{O420000} % outer cut left turn
\newcommand\KMizoConerLeft{O430000} % keyway left turn
\newcommand\KSotoMentoriRLeft{O440000} % 外側面取用 左回り
\newcommand\KUchiMentoriRLeft{O450000} % 内側面取用 左回り
\newcommand\KOLeftAR{O490005} % 外 左回り above right
\newcommand\KILeftAC{O490007} % 内 右回り above center
\newcommand\DKLthreeAC{O530001} % 内面溝 加工用 レベル3 AC
\newcommand\DKLthreeBD{O530002} % 内面溝 加工用 レベル3 BD
\newcommand\OpauseCheck{O900003} % move and pause in front of the door
\newcommand\OsensorOn{O910001} % touch sensor ON
\newcommand\OsensorOff{O910002} % touch sensor OFF
\newcommand\OwarmingupA{O915100} % for warming up
\newcommand\Owarmingup{O915101} % subprg for warming up
\newcommand\OtoolLengthA{O917100} % specified tool length correction auto measurement
\newcommand\OtoolLength{O919100} % tool length correction auto measure
%%%%% FIR INDEX %%%%%%%%%%%%%%%%%%
\newcommand{\expandafterindex}{\expandafter\index\expandafter}
%%%%% MACHINING NAME %%%%%%%%%%%%%%%%%%
\newcommand{\DMname}{Dマシニング}
\newcommand{\MMname}{Mマシニング}
\newcommand{\dimple}{内面溝}
\newcommand{\dimplekana}{ないめんみぞ}
%%%%% OTHER DEFINITION %%%%%%%%%%%%%%%%%%
\newcommand\ttNum{\ifmmode{\text{\texttt\#}}\else\texttt\#\fi}
\newcommand\cf{{\itshape cf.\,}}
\newcommand{\TBW}{\texorpdfstring{\small{\color{red}\,*}}{}}
%%%%% FOR PART WITH TABLE %%%%%%%%%%%%%%%%%%
\newcommand{\tPart}[4][]{
  \begingroup
  \clearrightpage
%  \@openrightfalse
  \let\oldnewpage\newpage
  \let\newpage\relax
  \part{#2\label{part:\thepart}}
  \addcontentsline{lop}{part}{\protect\numberline{\thepart}#2}%
  \ifx#1\relax\else\addcontentsline{#1}{part}{\protect\numberline{\thepart}#2}\fi
  \let\newpage\oldnewpage
  \clearpage
%  \@openrightfalse
  \thispagestyle{emptydate}
  \vspace*{0.1\textheight}%
  \begin{tablePart}{#3}
  #4
  \end{tablePart}%
%  \@openrightfalse
  \@mainmattertrue\pagestyle{main}
  \endgroup
}
%%%%% COMMON TABLE %%%%%%%%%%%%%%%%%%
\newenvironment{commonTable}[4]
{%
  \rowcolors{3}{gray!15!}{white}
  \if\relax\detokenize{#1}\relax
  \else
%    \setlength{\abovecaptionskip}{-3pt}
    \modcaptionof{table}{#1} % 追加したキャプション
    \addtocounter{table}{-1}
  \fi
  \setlength{\LTpre}{0pt}%
  \setlength{\LTpost}{3pt}%
  \setlength{\LTleft}{0pt}%
  \setlength{\LTright}{\fill}%
  \begin{longtable}{#2}
  \hline
  \rowcolor{orange!20}
  #3\\
  \hline
  \endfirsthead
  \hline
  \rowcolor{orange!20}
  #3\\
  \hline
  \endhead
  \hline
  \multicolumn{#4}{|r|}{\scriptsize 次ページへ続く} \\
  \hline
  \endfoot
  \hline
  \endlastfoot
}
{%
  \end{longtable}
}
%%%%% COMMON VARIABLES TABLE %%%%%%%%%%%%%%%%%%
\newenvironment{commonvariables}[4]
{%
  \if\relax\detokenize{#1}\relax
  \else
%    \setlength{\abovecaptionskip}{-2pt}
    \modcaptionof{table}{#1} % 追加したキャプション
    \addtocounter{table}{-1}
  \fi
  \setlength{\LTpre}{1pt}%
  \setlength{\LTpost}{3pt}%
  \setlength{\LTleft}{0pt}%
  \setlength{\LTright}{\fill}%
  \begin{longtable}{#2}
  \hline
  \rowcolor{orange!20}
  #3\\
  \hline
  \endfirsthead
  \hline
  \rowcolor{orange!20}
  #3\\
  \hline
  \endhead
  \hline
  \multicolumn{#4}{|r|}{\scriptsize 次ページへ続く} \\
  \hline
  \endfoot
  \hline
  \endlastfoot
}
{%
  \end{longtable}
}