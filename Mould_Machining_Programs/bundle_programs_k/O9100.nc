%
O9100(TOOL-LENGTH-MEASURMENT)
#1=#4001
#2=#4003
#24=#516(X)
#25=#517(Y)
#26=-820.(Z)
#21=#24-#5021+#4
#22=#25-#5022+#5
/G91G28Z0M19
/G0X#21Y#22
IF[#4012EQ54.1]GOTO20
#3=5223+[#4012-54]*20
GOTO21
N20#3=7003+[#4130-1]*20
N21#4=ABS[#26+#504]
M32
G4X2.
G53
/GOTO22
M0
N22#5=#5043
/G91G31P2Z-#4F#513
IF[#5063LE[#5-#4]]GOTO1
/G0Z#504.
#5=#5043-#504-#507
G91G31P2Z[-#504-#507-#507]F#514
IF[#5063LE#5]GOTO1
#[11000+#11]=0
#[10000+#11]=#5063+#[#3]+#5203+#505
G91G28Z0
M33
GOTO2
N1G91G28Z0
M33
#3000=141(TOOL-MESURE-ALARM)
N2G#1G#2M99
%
