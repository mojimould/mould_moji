%
O230001 (for AC dimples measurement)
(level 3: measurement dimple)
(I > 0: X+, I < 0: X-)

#767=#5041
(#767= current work X: start point X)

IF[#04EQ#0]GOTO800
IF[#04EQ0]GOTO800
(if I = 0 or empty, to N800)

IF[#1004EQ1]GOTO001
M117 (if the sensor is off, turn on)
G04X1. (wait 1.0s)

N001
IF[#04LT0]GOTO002
(if I < 0 to N002)
#33=1 (if I > 0, #33=1)
GOTO003
N002
#33=-1 (if I < 0, #33=-1)

N003
G91 G31 X[#33*15.0] F#514
(skip X+ or X-: 15.0, speed #514)
#768=#5061+#502+#33*[-#501+#512]
(#768= current machine X + hosei probe etc)
G90 G01 X#767 F6400
(G90 G01 X: to start point)
GOTO999 (to N999)

N800
G65 P900002 (sensor OFF)
#3000=121 (Argument Is Not Assigned)
M00 (are arguments ok?)

N999 M99

(Used Variables and Programs)

(Local variables)

(as received arguments)
(#04:I: +:X+direction, -:X-direction)

(as LHS)
(#33)


(Common variables)
(as RHS)
(#501: hosei: touch sensor signal delay)
(#502: hosei: probe center X)
(#512: probe radius)
(#514: default skip speed)
(as LHS)
(#767, #768)


(System variables)
(#1004: 1: sensor on, 0: off)
(#3000: alarm)
(#5041: current work X)
(#5061: skip position X)


(Subprograms)
(O90002)


(Used in other programs)
(#768)
%